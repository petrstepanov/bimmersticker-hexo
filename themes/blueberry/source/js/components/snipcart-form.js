var $=require("jquery"),DOM={},events=require("./events");function _cacheDom(t){DOM.$form=$(t),DOM.$inputsAndSelects=DOM.$form.find("select, input"),DOM.$selects=DOM.$form.find("select"),DOM.$selectColor=DOM.$form.find("select#color"),DOM.$snipcartButton=DOM.$form.find(".js--snipcart-add-item"),DOM.$submitButtons=$(document).find(".js--product-submit")}function _bindEvents(t){DOM.$inputsAndSelects.on("change input",function(){var t=DOM.$inputsAndSelects.index(this)+1;DOM.$snipcartButton.attr("data-"+("item-custom"+t+"-value"),$(this).val())}),DOM.$selects.on("change",function(){var n=0;DOM.$selects.each(function(){var t=$(this).find("option:selected");void 0!==t.data().extra&&(n+=parseFloat(t.data().extra))}),DOM.$submitButtons.each(function(){var t=parseFloat($(this).data().basePrice),e=(t+=n,$(this).data().baseCaption);$(this).html(e+"$"+t.toFixed(2).toString())})}),DOM.$selectColor.on("change",function(){var t=$(this).find("option"),e=$(this).find("option:selected").get(0),t=t.index(e);0<=t&&events.emit("colorIndexSelectedEvent",{index:t})}),DOM.$form.on("submit",function(t){t.preventDefault(),DOM.$snipcartButton.click()})}function init(t){t&&(_cacheDom(t),_bindEvents())}exports.init=init;